(()=>{"use strict";class i{_formdata;_url;_token;_opcion;_method;constructor(e="",t=1){this._token=e,this._opcion=t,this._method="POST"}setMethod(e){this._method=e}setFormData(e){this._formdata=e}setUrl(e){this._url=e}setOption(e){this._opcion=e,this._formdata.append("opcion",this._opcion)}async fetchDataAsync(){var e=this._token??this._token,t=a(3),e=await(await fetch(this._url,{headers:{Authorization:"Bearer "+e},method:this._method,body:this._formdata??this._formdata})).json();return await t.close(),e}}const a=(e,t=null,a=null)=>{let i="";var r=` 
    <br>
    <div class="lds-spinner" style="height: 13vh;">
        <div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div>
    </div>

    `,o={confirmButtonText:null!==a?a:"aceptar",loaderHtml:r,imageWidth:100,imageHeight:100,html:t,showConfirmButton:!0};switch(e){case 0:o.html="Completa los campos REQUERIDOS.",i=Swal.fire(o);break;case 1:o.html="guardado OK",i=Swal.fire(o);break;case 2:o.html="error de conexion.",i=Swal.fire(o);break;case 3:o.html=r+"<br>procesando...",o.showConfirmButton=!1,i=Swal.fire(o);break;case 4:o.html="solo podes adjuntar un archivo. recargar la web para repetir.",i=Swal.fire(o);break;case 5:o.html="ya existe ese e-mail en BD. o no es un email valido.",i=Swal.fire(o);break;case 6:o.html="ERROR: no estas autenticado.",i=Swal.fire(o);break;case 7:i=Swal.fire(o);break;default:return i}return i};let r="";const e={home:(r="https://nutribarf.ar")+"/api",data:r+"/api/data",calendario:r+"/api/calendario",ingresar:r+"/api/ingresar",adjuntosDir:r+"/api/adjuntos"};const t=document.querySelector("#links-menu-wm"),o=document.querySelector("#menu-wm"),n=document.querySelector('img[name="avatar-icon-wm"]'),s=document.querySelector('a[href="ingresar"]').parentNode,l=document.querySelector(".nombre-user-wm"),d=document.querySelector('li a[href="registro"]').parentNode;o.addEventListener("click",()=>{t.style.visibility="visible"}),t.addEventListener("mouseover",()=>{t.style.visibility="visible"}),t.addEventListener("mouseout",()=>{t.style.visibility="hidden"}),(async()=>{var e,t,a=sessionStorage.getItem("token");return null!==a?(e=r+"/api/tokenIsValid",a=a,t=new FormData,(a=new i(a)).setFormData(t),a.setUrl(e),t=await a.fetchDataAsync()):0})().then(e=>{var t;1===e.response?(n.src=(t=e.mascotas,void 0!==(t=JSON.parse(t))[0]&&void 0!==(t=t.find(e=>""!==e.imagen))&&void 0!==t.imagen?"adjuntos/"+t.imagen:"./views-utils/img/avatar1.png"),o.style.visibility="visible",s.remove(),l.textContent="Hola, "+e.user+" !",d.remove()):(o.style.visibility="hidden",s.visibility="visible")}),document.querySelector(".logout").addEventListener("click",()=>{sessionStorage.removeItem("token"),window.location.href=e.home});document.querySelector(".misdatos").addEventListener("click",()=>(async()=>{window.location.href=e.data})()),document.querySelector(".calendario").addEventListener("click",()=>(async()=>{window.location.href=e.calendario})()),(async e=>{let t="";e=new i(e);return e.setMethod="POST",e.setUrl(r+"/api/protegida/get-calendario"),await e.fetchDataAsync().then(e=>{t=((i,e)=>{let r="";const o=new Date;return e.reduce((e,t)=>{var a=new Date(t.start).getTime()-o.getTime(),a=Math.floor(a/864e5);return r=0<=a&&a<=i?[...e,t]:r},[])})(8,JSON.parse(e.eventosCalendario))}),t})(sessionStorage.getItem("token")).then(e=>{if(0<e.length&&(t="/api/data",window.location.pathname.includes(t)?(console.log("La ruta "+t+" está presente en la URL"),!0):(console.log("La ruta "+t+" NO está presente en la URL"),!1))){let t="";e.map(e=>{t+=`
            <li class="list-group-item">${(e=>{e=new Date(e);return new Intl.DateTimeFormat("es-AR",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric",timeZone:"America/Argentina/Buenos_Aires"}).format(e)})(e.start)}: <br> <b>${e.title}</b></li>
        `});t;a(7,"<p>Usted tiene eventos cercanos en el calendario:</p><br> "+t,"aceptar")}var t})})();